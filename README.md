![_0d9dff30-31b7-499c-ae59-2787aa630094](https://camo.githubusercontent.com/580b7032c938b3cbf4f2547383a8d43d86aba159622747f1993b0e45c04f0665/68747470733a2f2f666173746170692e7469616e676f6c6f2e636f6d2f696d672f6c6f676f2d6d617267696e2f6c6f676f2d7465616c2e706e67)

# FastAPI Template

## Built-In Features:
- [JWT Auth](https://fastapi.tiangolo.com/tutorial/security/oauth2-jwt/)
- Admin ([SQLAdmin](https://aminalaee.dev/sqladmin/))
- ORM ([SQLModel](https://sqlmodel.tiangolo.com/) / [SQLAlquemy](https://www.sqlalchemy.org/))
- Migration ([Alembic](https://alembic.sqlalchemy.org/en/latest/))
- Tests ([Pytest](https://docs.pytest.org/en/stable/))
- Coverage ([Coverage](https://coverage.readthedocs.io/en/7.6.1/))
- camelCase API
- [Docker Compose](https://www.docker.com/)
- [PostgresSQL](https://www.postgresql.org/)

## Quick Start

1. Install [Docker](https://www.docker.com) on your machine.
2. Start Docker.
3. Add the environment variables in the `.env` file.
4. Open the terminal in the root of the project.
5. Build the image:

```
docker compose build
```

6. Run the containers to create the Database:

```
docker compose up
```

7. Stop the containers pressing `Ctrl+C` or:

```
docker compose down
```

8. Run the migrations:

```
docker compose run web alembic upgrade head
```

9. Run the containers

```
docker compose up
```

10. When you want to stop the containers, press `Ctrl+C` or:

```
docker compose down
```

## API Documentation

1. Run the containers

```
docker compose up
```

2. Access:

- Swagger: http://localhost:8000/api/v1/docs
- Redoc: http://localhost:8000/api/v1/redoc

## Run Tests

```
docker compose run web pytest
```

## Run Tests with Coverage

1. Run tests with [Pytest](https://docs.pytest.org/en/7.1.x/contents.html).

```
docker compose run web coverage run -m pytest
```

2. To check the test coverage, it is possible to use Terminal Report or HTML.

### Terminal Report

3. Run:

```
docker compose run web coverage report
```

![image](https://github.com/marcelloinfante/happy-scribe-api/assets/80683232/9fc5a849-2cea-42e4-8797-17c4ead8a568)

### HTML

3. Run:

```
docker compose run web coverage html
```

4. Initialize the `/htmlcov` directory generated by the test coverage using the [Live-Server](https://marketplace.visualstudio.com/items?itemName=ritwickdey.LiveServer) extension in VSCode.
5. Go to http://localhost:5500/htmlcov/
6. Check the test coverage via HTML:

![image](https://github.com/marcelloinfante/happy-scribe/assets/80683232/5f0c71a3-50ac-4fe8-bf0c-ef90aedf890a)

## Delete Database

```
docker compose down -v
```

## Create migration

```
docker compose run web alembic revision --autogenerate -m “first_commit”
```

## Migrate

```
docker compose run web alembic upgrade head
```

## Downgrade

```
docker compose run web alembic downgrade base
```

## List Migrations History

```
docker compose run web alembic history
```

## Run Commands in Container terminal

```
docker compose run web COMMAND
```

## Seeds

```
docker compose run web python app/seeds.py
```
